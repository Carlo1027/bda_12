setwd("D:/bda_12")
load(file = "clase_06/Modelo_Total/df_desa_F.Rdata")
install.packages("caTools")
library(caTools)
set.seed(123)
split <- sample.split(df.desa.F$Exited, SplitRatio = 0.7)
df.desa.F.train <- subset(df.desa.F, split == TRUE)
df.desa.F.test <- subset(df.desa.F, split == FALSE)
library(rpart)
modelo1 <- rpart(formula = Exited ~ . ,
data = df.desa.F.train,
method = "class")
modelo2 <- rpart(formula = Exited ~ CreditScore
+ Gender
+ Age
+ Tenure
+ Balance
+ NumOfProducts
+ HasCrCard
+ IsActiveMember
+ EstimatedSalary,
data = df.desa.F.train,
method = "class")
saveRDS(modelo1, "clase_06/Modelo_Total/modelo1.rds")
saveRDS(modelo2, "clase_06/Modelo_Total/modelo2.rds")
library(rpart.plot)
rpart.plot(modelo1)
install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(modelo1)
saveRDS(modelo1, "clase_07/modelo1.rds")
saveRDS(modelo2, "clase_07/modelo2.rds")
head(df.desa.F.train)
View(df.desa.F.train)
df<-df.desa.F.train
df$Geography <- factor(df$Geography,
levels = c("France", "Spain", "Germany"),
labels = c(1,2,3))
df$Gender <- factor(df$Gender,
levels = c("Female", "Male"),
labels = c(1,2))
summary(df)
modelo3<-glm(formula = Exited ~ . ,
family = binomial,
data = df)
summary(modelo3)
saveRDS(modelo3, "clase_07/modelo3_RegLog.rds")
saveRDS(modelo3, "clase_06/Modelo_Total//modelo3_RegLog.rds")
df<-df.desa.F.test
df$Geography <- factor(df$Geography,
levels = c("France", "Spain", "Germany"),
labels = c(1,2,3))
df$Gender <- factor(df$Gender,
levels = c("Female", "Male"),
labels = c(1,2))
p_pred <- predict(object = modelo3, newdata = df, type = "response")
summary(p_pred)
y_pred = ifelse(p_pred > 0.5, 1, 0)
cm<- table(y_pred, df.desa.F.test$Exited)
cm
(2208+131)/2876
model_1 <- readRDS("clase_07/modelo1.rds")
model_2 <- readRDS("clase_07/modelo2.rds")
model_3 <- readRDS("clase_07/modelo3_RegLog.rds")
y_pred <- predict(object = mod)
load(file = "clase_06/Modelo_Total/df_desa_F.Rdata")
load(file = "clase_06/Modelo_Total/df_desa_F.Rdata")
library(caTools)
set.seed(123)
split <- sample.split(df.desa.F$Exited, SplitRatio = 0.7)
df.desa.F.train <- subset(df.desa.F, split == TRUE)
df.desa.F.test <- subset(df.desa.F, split == FALSE)
save(df.desa.F.train, file = "clase_06/Modelo_Total/df_desa_F_train.Rdata")
save(df.desa.F.test, file = "clase_06/Modelo_Total/df_desa_F_test.Rdata")
model_1 <- readRDS("clase_07/modelo1.rds")
model_2 <- readRDS("clase_07/modelo2.rds")
model_3 <- readRDS("clase_07/modelo3_RegLog.rds")
load(file = "clase_06/Modelo_Total/df_desa_F_test.Rdata")
cm <- table(y_pred, df.desa.F.test$Exited)
y_pred <- predict(object = model_1, type = "class", newdata = df.desa.F.test)
cm <- table(y_pred, df.desa.F.test$Exited)
cm
cm[[0][0]]
cm[0,0]
cm[,0]
cm[1,1]
(cm[1,1]+cm[2,2])/sum(cn)
(cm[1,1]+cm[2,2])
(cm[1,1]+cm[2,2])/sum(cm)
(cm[1,2])/sum(cm[1,]) # Falso Positivo, Error tipo 1!!!
y_pred <- predict(object = model_2, type = "class", newdata = df.desa.F.test)
cm <- table(y_pred, df.desa.F.test$Exited)
(cm[1,1]+cm[2,2])/sum(cm) #Exito del modelo = 0.85
(cm[1,2])/sum(cm[1,]) # Falso Positivo, Error tipo 1!!! = 0.14
df<-df.desa.F.train
df$Geography <- factor(df$Geography,
levels = c("France", "Spain", "Germany"),
labels = c(1,2,3))
df$Gender <- factor(df$Gender,
levels = c("Female", "Male"),
labels = c(1,2))
p_pred <- predict(object = model_3, type = "response", newdata = df)
y_pred = ifelse(p_pred > 0.5, 1, 0)
cm <- table(y_pred, df.desa.F.test$Exited)
(cm[1,1]+cm[2,2])/sum(cm) #Exito del modelo = 0.84
(cm[1,2])/sum(cm[1,]) # Falso Positivo, Error tipo 1!!! = 0.14
df<-df.desa.F.test
df$Geography <- factor(df$Geography,
levels = c("France", "Spain", "Germany"),
labels = c(1,2,3))
df$Gender <- factor(df$Gender,
levels = c("Female", "Male"),
labels = c(1,2))
p_pred <- predict(object = model_3, type = "response", newdata = df)
y_pred = ifelse(p_pred > 0.5, 1, 0)
cm <- table(y_pred, df.desa.F.test$Exited)
(cm[1,1]+cm[2,2])/sum(cm) #Exito del modelo = 0.84
(cm[1,2])/sum(cm[1,]) # Falso Positivo, Error tipo 1!!! = 0.14
df <- read.csv("clase_07/Regresion_Profit/50_Startups.csv")
df <- read.csv("clase_07/Regresion_Profit/50_Startups.csv")
View(df)
summary(df)
df <- read.csv("clase_07/Regresion_Profit/50_Startups.csv")
summary(df)
#Codificando la variable categorica
df$State <- factor(df$State,
levels = c("New York", "California", "Florida"),
labels = c(1,2,3))
save(df, file = "clase_07/Regresion_Profit/df_Total.Rdta")
library(caTools)
set.seed(123)
split <- sample.split(df$Profit, SplitRatio = 0.8)
df.train <- subset(df, split == TRUE)
df.test <- subset(df, split == FALSE)
save(df.train, file = "clase_07/Regresion_Profit/df_train.Rdata")
save(df.test, file = "clase_07/Regresion_Profit/df_test.Rdata")
modelo_lm <- lm(formula = Profit ~ ., data = df.train)
summary(modelo_lm)
summary(df)
modelo_lm2 <- lm(formula = Profit ~ R.D.Spend + Administration + Marketing.Spend,
data = df.train)
summary(modelo_lm2)
modelo_lm3 <- lm(formula = Profit ~ R.D.Spend + Marketing.Spend,
data = df.train)
summary(modelo_lm3) # Adjusted R-squared:  0.9457
modelo_lm4 <- lm(formula = Profit ~ R.D.Spend,
data = df.train)
summary(modelo_lm4) # Adjusted R-squared:  0.9468
saveRDS(modelo_lm3, "clase_07/Regresion_Profit/modelo_lm.rds")
